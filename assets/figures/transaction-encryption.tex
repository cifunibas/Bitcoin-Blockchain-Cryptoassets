\begin{tikzpicture}[domain=-8:8,scale=0.75, every node/.style={scale=0.76}]

\draw[dashed,thick] (-3.3,0) -- (1.3,0) -- (1.3,5.5) -- (-3.3,5.5) node[midway,below]{\texttt{Edith}}--(-3.3,0);

\filldraw[fill=highlight!50,dotted,thick] (-3.15,3.3) -- (1.15,3.3) -- (1.15,4.7) -- (-3.15,4.7) -- (-3.15,3.3) node[midway, right=0.0cm ,text width=4.1cm]{\footnotesize{Edith: ``I transfer one  Bitcoin unit to Daniel.''}};

\draw[->,thick] (-1,3.2) to[bend right = 20] (1.5,2);

\draw[dashed,thick] (5.9,0) -- (10.5,0) -- (10.5,5.5) -- (5.9,5.5) node[midway,below]{\texttt{Tony}}--(5.9,0);

\filldraw[fill=highlight!50,dotted,thick] (6.05,3.3) -- (10.35,3.3) -- (10.35,4.7) -- (6.05,4.7) -- (6.05,3.3) node[midway, right=0.0cm ,text width=4.1cm]{\footnotesize{Edith: ``I transfer one Bitcoin unit to Daniel.''}};

\draw[->,thick] (5.7,2) to[bend right = 20] (8.2,3.2);

\filldraw[fill=highlight!50,dotted,thick] (1.6,1.3) -- (5.6,1.3) node[midway,below]{\footnotesize{Encrypted message}}-- (5.6,2.7) -- (1.6,2.7) -- (1.6,1.3) node[midway, right=0.13cm ,text width=4cm]{\footnotesize{gpnsa3ijswnhfajdoc76vc iqnwyxm1cidifjozerwfao}};

%private key
  \filldraw[color=black] (-1.2,2.2) circle (5pt);
  \filldraw[color=white!15] (-1.2,2.2) circle (2pt);
  \filldraw[yshift=-0.05cm, xshift=0.1cm,color = black] (-1.2,2.2) rectangle ++(15pt,3pt) ;
  \filldraw[yshift=-0.13cm, xshift=0.4cm,color = black] (-1.2,2.2) rectangle ++(1pt,4pt) ;
  \filldraw[yshift=-0.13cm, xshift=0.5cm,color = black] (-1.2,2.2) rectangle ++(1pt,4pt) ;
  \draw[color=black] plot (-1,2.1)                  node[align=center,below=0.1cm, text width= 4.5cm] {\footnotesize{Encryption/signature using Edith's  \color{focus} private \color{black} key}};

%public key
  \filldraw[color=black] (8,2.2) circle (5pt);
  \filldraw[color=white!15] (8,2.2) circle (2pt);
  \filldraw[yshift=-0.05cm, xshift=0.1cm,color = black] (8,2.2) rectangle ++(15pt,3pt) ;
  \filldraw[yshift=-0.13cm, xshift=0.4cm,color = black] (8,2.2) rectangle ++(1pt,4pt) ;
  \filldraw[yshift=-0.13cm, xshift=0.5cm,color = black] (8,2.2) rectangle ++(1pt,4pt) ;
  \draw[color=black] plot (8.2,2.1)                  node[align=center,below=0.1cm, text width= 4.5cm] {\footnotesize{Decryption/verifying using Edith's \color{focus} public \color{black}key}};

\end{tikzpicture}
