% Choose one to switch between slides and handout
\documentclass[]{beamer}
%\documentclass[handout]{beamer}

% Video Meta Data
\title{Bitcoin, Blockchain and Cryptoassets}
\subtitle{Payment Channels and Lightning Network}
\author{Prof. Dr. Fabian Schär}
\institute{University of Basel}

% Config File
\input{../config/config.tex}
\input{../config/green_checkmark.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\thispagestyle{empty}
\begin{frame}[noframenumbering]
	\titlepage
\end{frame}
%%%

%%%
\begin{frame}{Basic Idea of State Channels}

\textbf{What we know already:}
\begin{itemize}
	\item The Bitcoin network today is facing scalability challenges that cannot be solved through Block cadence or size increases.
	\item \texttt{Economic scripting}, allows to account for different incentive scenarios in the context of transactions.
\end{itemize}

\vspace{1.5 em}

\uncover<2->{
\textbf{State channels} present another \color{focus} scaling option\color{black}, reducing the on-chain transaction load from \color{focus}two agents that exchange payments frequently:\color{black}

\begin{itemize}
	\item Establishment and funding of payment channel.
	\item Off-chain transaction handling between the two agents.
	\item Channel closure with net settling of transactions on-chain.
\end{itemize}
}

\end{frame}
%%%


%%%
\begin{frame}{A Naïve Implementation}


\begin{minipage}{0.1\linewidth}
		\vspace{-3 cm}
		\only<-5>{
		\begin{figure}[t]
			\resizebox{2.5cm}{!}{
			\begin{tikzpicture}[scale=0.7, every node/.style={scale=0.7}]
				\input{../assets/figures/utxo_alice.tex}
			\end{tikzpicture}}
		\end{figure}}
		\only<6->{
		\begin{figure}[t]
			\resizebox{2.5cm}{!}{
			\begin{tikzpicture}[scale=0.7, every node/.style={scale=0.7}]
				\input{../assets/figures/utxo_alice2.tex}
			\end{tikzpicture}}
		\end{figure}}
		\centering
		\includegraphics[width=1cm]{../assets/images/agents/handing_right}
		\\ \hspace{-0.35cm} \textbf{Alice}
\end{minipage}%
\begin{minipage}{0.8\linewidth}
		\vspace{1.2 cm}
		\only<1,6>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}
						\filldraw[yshift=-0.05cm, xshift=0.1cm,color = white!15, thick, draw=white] (-3,-5.9) rectangle ++(8cm,5.7cm);
				\end{tikzpicture}}
		\end{figure}}
		\only<2>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/naivesc_commitment_tx1.tex}
				\end{tikzpicture}}
			\end{figure}}
		\only<3>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/naivesc_commitment_tx2.tex}
				\end{tikzpicture}}
			\end{figure}}
		\only<4>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/naivesc_commitment_tx3.tex}
				\end{tikzpicture}}
			\end{figure}}
		\only<5>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/naivesc_counter_tx.tex}
				\end{tikzpicture}}
			\end{figure}
			\vspace{1cm}			
			}
		\begin{figure}
			\centering
			\resizebox{3cm}{!}{
				\begin{tikzpicture}[scale=1, every node/.style={scale=1}]
					\input{../assets/figures/p2p}
			\end{tikzpicture}}\\
			\textbf{Bitcoin Network}
		\end{figure}
		\vspace{-2.9cm}
		\uncover<6 ->{
		\begin{figure}
			\resizebox{2.5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/naivesc_counter_tx.tex}
			\end{tikzpicture}}
		\end{figure}}		
	\end{minipage}%
\begin{minipage}{0.1\linewidth}
	\vspace{1.2cm}
	\centering
		\includegraphics[width=1cm]{../assets/images/agents/handing_left}
		\\ \hspace{0.3cm}\textbf{Bob}
		\vspace{-0.5cm}
		\begin{figure}
		\hspace{-1.7cm}
		\resizebox{2.5cm}{!}{
				\begin{tikzpicture}[scale=0.7, every node/.style={scale=0.7}]
					\input{../assets/figures/naivesc_commitment_tx_stack.tex}
				\end{tikzpicture}}
		\end{figure}
	
\end{minipage}


\end{frame}
%%%


%%%
\begin{frame}{Unidirectional Payment Channel (UPC)}

\begin{minipage}{0.1\linewidth}
		\vspace{-3 cm}
		\uncover<-1>{
		\begin{figure}[t]
			\resizebox{2.5cm}{!}{
			\begin{tikzpicture}[scale=0.7, every node/.style={scale=0.7}]
				\input{../assets/figures/utxo_alice.tex}
			\end{tikzpicture}}
		\end{figure}}
		\centering
		\includegraphics[width=1cm]{../assets/images/agents/handing_right}
		\\ \hspace{-0.35cm} \textbf{Alice}
\end{minipage}%
\begin{minipage}{0.8\linewidth}
		\vspace{-0.5 cm}
		\uncover<2->{
			\begin{figure}
				\resizebox{2.5cm}{!}{
				\begin{tikzpicture}[scale=0.7, every node/.style={scale=0.7}]
				\input{../assets/figures/utxo_multisig.tex}
				\end{tikzpicture}}
		\end{figure}}
		\vspace{-0.5cm}
		\only<1>{
			\begin{figure}
				\resizebox{7cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/funding_transaction.tex}
				\end{tikzpicture}}
			\end{figure}
			\vspace{1cm}}
		\only<2>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}
						\filldraw[yshift=-0.05cm, xshift=0.1cm,color = white!15, thick, draw=white] (-3,-5.9) rectangle ++(8cm,5.7cm);
				\end{tikzpicture}}
		\end{figure}}
		\only<3>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/upc_commitment_tx1.tex}
				\end{tikzpicture}}
			\end{figure}}
		\only<4>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/upc_commitment_tx2.tex}
				\end{tikzpicture}}
			\end{figure}}
		\only<5>{
			\begin{figure}
				\resizebox{5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/naivesc_counter_tx.tex}
				\end{tikzpicture}}
			\end{figure}
			\vspace{cm}			
			}
		\vspace{-0.2cm}
		\begin{figure}
			\centering
			\resizebox{3cm}{!}{
				\begin{tikzpicture}[scale=1, every node/.style={scale=1}]
					\input{../assets/figures/p2p}
			\end{tikzpicture}}\\
			\textbf{Bitcoin Network}
		\end{figure}
		\vspace{-2.9cm}
		\only<2>{
		\begin{figure}
			\resizebox{2.5cm}{!}{
				\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
					\input{../assets/figures/funding_transaction.tex}
			\end{tikzpicture}}
		\end{figure}}		
	\end{minipage}%
\begin{minipage}{0.1\linewidth}
	\vspace{1.2cm}
	\centering
		\includegraphics[width=1cm]{../assets/images/agents/handing_left}
		\\ \hspace{0.3cm}\textbf{Bob}
		\vspace{-0.5cm}
		\begin{figure}
		\hspace{-1.7cm}
		\resizebox{2.5cm}{!}{
				\begin{tikzpicture}[scale=0.7, every node/.style={scale=0.7}]
					\input{../assets/figures/upc_commitment_stack.tex}
				\end{tikzpicture}}
		\end{figure}
	
\end{minipage}

\end{frame}
%%%

%%%
\begin{frame}{UPC: Exchanging Payments}


\begin{minipage}{0.1\linewidth}
		\vspace{-0.5cm}
		\centering
		\includegraphics[width=1cm]{../assets/images/agents/handing_right}
		\\ \hspace{-0.35cm} \textbf{Alice}
	\end{minipage}%
	\begin{minipage}{0.8\linewidth}
		\begin{figure}
		\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
			\input{../assets/figures/funding_transaction.tex}
		\end{tikzpicture}
		\vspace{0.5cm}
		\uncover<2 ->{
		\begin{tikzpicture}[scale=0.9, every node/.style={scale=0.9}]
			\input{../assets/figures/refund_transaction.tex}
		\end{tikzpicture}
		}
		\end{figure}
	\end{minipage}%
	\begin{minipage}{0.1\linewidth}
		\vspace{-0.5cm}
		\centering
		\includegraphics[width=1cm]{../assets/images/agents/handing_left}
		\\ \hspace{0.3cm}\textbf{Bob}
	\end{minipage}

\end{frame}
%%%




%%%
\begin{frame}{UPC: Incentives and Role of Timelocks}


\end{frame}
%%%


%%%
\begin{frame}{Bidirectional Payment Channel (BPC): Setup}




\end{frame}
%%%


%%%
\begin{frame}{BPC: Incentives and Role of Timelocks}


\end{frame}
%%%


%%%
\begin{frame}{Channels with Asymmetric Revocable Commitments (CwARC)}


\end{frame}
%%%


%%%
\begin{frame}{Challenges with Payment Channels}


\end{frame}
%%%

%%%
\begin{frame}{Lightning Network Approach (simplified)}


\end{frame}
%%%

%%%
\begin{frame}{Lightning Network Implications}


\end{frame}
%%%

%%%
\begin{frame}{SUPC: Setup Transactions}


\end{frame}
%%%

	
%%%
\begin{frame}{SUPC: First Payment}
	
\end{frame}
%%%

%%%
\begin{frame}{Bib-References}
		Read the Bitcoin Whitepaper, \cite{nakamotoBitcoin2008}.
\end{frame}
%%%

%%%
\begin{frame}%[allowframebreaks]
\frametitle{References and Recommended Reading}
	\bibliographystyle{amsplain}
	\bibliography{../assets/bib/refs}
\end{frame}
%%%

\end{document}